<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing the RC-test to the Fisher’s exact test • wext</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparing the RC-test to the Fisher’s exact test">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wext</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/compare_rc_to_fisher.html">Comparing the RC-test to the Fisher's exact test</a>
    </li>
    <li>
      <a href="../articles/comparing_swappers.html">Comparing Edge Swap Algorithms</a>
    </li>
    <li>
      <a href="../articles/computing_probabilities.html">Computing the Weighted Exclusivity Test (WExT)</a>
    </li>
    <li>
      <a href="../articles/simpleexample-hardway.html">Simple Example (the hard way)</a>
    </li>
    <li>
      <a href="../articles/statistics.html">WExT Statistics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/jhrcook/wext">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/JoshDoesa">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Comparing the RC-test to the Fisher’s exact test</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhrcook/wext/blob/master/vignettes/compare_rc_to_fisher.Rmd"><code>vignettes/compare_rc_to_fisher.Rmd</code></a></small>
      <div class="hidden name"><code>compare_rc_to_fisher.Rmd</code></div>

    </div>

    
    
<p>This vignette compares the results of the classic one-sided Fisher’s test for mutual exclusivity and the Row-Column Exclusivity test on a simple data set.</p>
<div id="the-input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-input-data" class="anchor"></a>The Input Data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">simple_dataset <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_name =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(sample_name, <span class="dt">levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample_name, <span class="dt">y =</span> mutated_gene)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">"grey50"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="compare_rc_to_fisher_files/figure-html/viz_data-1.png" width="700"></p>
<p>From the plot, it seems that genes “c” and “d” strongly co-mutate while “a” and “b” are strongly mutually exclusive. Samples “1” and “2” have more mutation than the others while samples “11” and “12” have only two mutations each. This information is taken into account in the RC test but not the one-sided Fisher’s exact test.</p>
</div>
<div id="one-sided-fishers-exact-test" class="section level2">
<h2 class="hasAnchor">
<a href="#one-sided-fishers-exact-test" class="anchor"></a>One-sided Fisher’s exact test</h2>
<p>The following functions perform a one-sided Fisher’s exact test for a odds ratio less than 1. <code>one_sided_fish()</code> takes the data and the column holding the samples and their mutations. It then runs each combination of two genes through the Fisher’s exact test in <code>single_one_sided_fish()</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># conduct a one-sided Fisher's exact test between all genes in `mutgene_col`</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># of `dat`</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">one_sided_fish &lt;-<span class="st"> </span><span class="cf">function</span>(dat, sample_col, mutgene_col,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                           <span class="dt">which_test =</span> <span class="st">"exclusivity"</span>) {</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    original_colnames &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">        rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/as_string.html">as_string</a></span>(rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">ensym</a></span>(sample_col)),</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">        rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/as_string.html">as_string</a></span>(rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">ensym</a></span>(mutgene_col))</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    </a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    <span class="co"># determine side of Fisher's given the test to perform</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    <span class="cf">if</span> (which_test <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"exclusivity"</span>, <span class="st">"e"</span>)) {</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">      side &lt;-<span class="st"> "l"</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">    } <span class="cf">else</span> <span class="cf">if</span> (which_test <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"comutation"</span>, <span class="st">"c"</span>)) {</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">      side &lt;-<span class="st"> "g"</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">    </a>
<a class="sourceLine" id="cb2-17" data-line-number="17">    <span class="co"># enquote the input column names</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">    sample_col &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">enquo</a></span>(sample_col)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">    mutgene_col &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">enquo</a></span>(mutgene_col)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">    <span class="co"># vector of all genes</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    genes &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/eval_tidy.html">eval_tidy</a></span>(mutgene_col, dat) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>()</a>
<a class="sourceLine" id="cb2-23" data-line-number="23">    </a>
<a class="sourceLine" id="cb2-24" data-line-number="24">    results_tib &lt;-<span class="st"> </span><span class="kw">make_empty_fish_results_tracker</span>(genes, <span class="dv">2</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="st">        </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span>(</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">            single_one_sided_fish,</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">            <span class="dt">data =</span> dat, <span class="dt">sample_col =</span> <span class="op">!!</span>sample_col,</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">            <span class="dt">mutgene_col =</span> <span class="op">!!</span>mutgene_col, <span class="dt">side =</span> side</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">        ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="st">        </span><span class="kw">bind_rows</span>()</a>
<a class="sourceLine" id="cb2-31" data-line-number="31">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(results_tib)</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">}</a>
<a class="sourceLine" id="cb2-33" data-line-number="33"></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co"># conduct a one-sided Fisher's exact test between the genes in `gene_set` using</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co"># the data in `data`</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36">single_one_sided_fish &lt;-<span class="st"> </span><span class="cf">function</span>(gene_sets, data, sample_col, mutgene_col, side) {</a>
<a class="sourceLine" id="cb2-37" data-line-number="37">    <span class="co"># enquote the input column names</span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38">    sample_col &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">enquo</a></span>(sample_col)</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">    mutgene_col &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">enquo</a></span>(mutgene_col)</a>
<a class="sourceLine" id="cb2-40" data-line-number="40">    cont_tbl &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="st">        </span><span class="kw">make_contingency_table</span>(<span class="dt">genes =</span> gene_sets, <span class="op">!!</span>sample_col, <span class="op">!!</span>mutgene_col)</a>
<a class="sourceLine" id="cb2-42" data-line-number="42">    fe &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/fisher.test">fisher.test</a></span>(cont_tbl, <span class="dt">alternative =</span> side)</a>
<a class="sourceLine" id="cb2-43" data-line-number="43">    tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">gene_sets =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(gene_sets),</a>
<a class="sourceLine" id="cb2-44" data-line-number="44">                   <span class="dt">fish_pval =</span> fe<span class="op">$</span>p.value,</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">                   <span class="dt">oddsratio =</span> fe<span class="op">$</span>estimate)</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">}</a></code></pre></div>
<p><code>make_contingency_table()</code> creates the 2x2 contingency table as input for the Fisher’s exact test in <code>single_one_sided_fish()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># construct the contingency table (2x2)</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">make_contingency_table &lt;-<span class="st"> </span><span class="cf">function</span>(dat, genes, sample_col, mutgene_col) {</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    <span class="co"># enquote the input column names</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    sample_col &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">enquo</a></span>(sample_col)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    mutgene_col &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/quotation.html">enquo</a></span>(mutgene_col)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">    genes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(genes)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">    g1 &lt;-<span class="st"> </span>genes[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    g2 &lt;-<span class="st"> </span>genes[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    all_samples &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/eval_tidy.html">eval_tidy</a></span>(sample_col, dat) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>()</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">    </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">    g1_mut &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(dat, <span class="op">!!</span>mutgene_col <span class="op">==</span><span class="st"> </span><span class="op">!!</span>g1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(<span class="op">!!</span>sample_col) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>()</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">    g1_wt &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">setdiff</a></span>(all_samples, g1_mut)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">    g2_mut &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(dat, <span class="op">!!</span>mutgene_col <span class="op">==</span><span class="st"> </span><span class="op">!!</span>g2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(<span class="op">!!</span>sample_col) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>()</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">    g2_wt &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">setdiff</a></span>(all_samples, g2_mut)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">    </a>
<a class="sourceLine" id="cb3-18" data-line-number="18">    A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">intersect</a></span>(g1_mut, g2_mut) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>()</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">    B &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">intersect</a></span>(g1_mut, g2_wt) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>()</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">    C &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">intersect</a></span>(g1_wt, g2_mut) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>()</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">    D &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sets">intersect</a></span>(g1_wt, g2_wt) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>()</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">    </a>
<a class="sourceLine" id="cb3-23" data-line-number="23">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(A, B, C, D), <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">}</a></code></pre></div>
<p><code><a href="../reference/results_tracker.html">make_empty_results_tracker()</a></code> initializes the results tracker with a single column <code>gene_sets</code> containing lists of ever combination of <code>k</code> genes in <code>gs</code>. For this use, <code>k = 2</code> and <code>seed_genes</code> can be ignored (<code>seed_genes = c()</code>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># start the results tracking tibble with the gene sets and t_BM_gr = 0</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">make_empty_fish_results_tracker &lt;-<span class="st"> </span><span class="cf">function</span>(gs, k, seed_genes) {</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    combs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/combn">combn</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(gs), k) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">        </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(<span class="dv">2</span>, list) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">        </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(<span class="dt">recursive =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(seed_genes) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">        idx &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_lgl</a></span>(gs, <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/any">any</a></span>(seed_genes <span class="op">%in%</span><span class="st"> </span>.x))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">        combs &lt;-<span class="st"> </span>combs[idx]</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">    }</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">    tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">gene_sets =</span> combs)</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">}</a></code></pre></div>
</div>
<div id="comparing-tests-for-mutual-exclusivity" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-tests-for-mutual-exclusivity" class="anchor"></a>Comparing tests for mutual exclusivity</h2>
<div id="one-sided-fishers-exact-test-1" class="section level3">
<h3 class="hasAnchor">
<a href="#one-sided-fishers-exact-test-1" class="anchor"></a>One-sided Fisher’s exact test</h3>
<p>Running the test produces results that generally agree with the prior visualization. The mutations to “a” and “b” seem to be the only significantly mutually exclusive set.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># column `gene_sets_print` shows the gene sets when printed</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">fish_test &lt;-<span class="st"> </span><span class="kw">one_sided_fish</span>(simple_dataset, sample_name, mutated_gene) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gene_sets_print =</span> purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span>(gene_sets, <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(.x[[<span class="dv">1</span>]], <span class="st">"-"</span>, .x[[<span class="dv">2</span>]]))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">    </span><span class="kw">arrange</span>(fish_pval, gene_sets_print, oddsratio)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">fish_test</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; # A tibble: 28 x 4</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;    gene_sets fish_pval oddsratio gene_sets_print</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;    &lt;list&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;          </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;  1 &lt;chr [2]&gt;   0.00932     0     a-b            </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  2 &lt;chr [2]&gt;   0.308       0     a-g            </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  3 &lt;chr [2]&gt;   0.308       0     e-b            </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;  4 &lt;chr [2]&gt;   0.343       0.362 c-b            </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  5 &lt;chr [2]&gt;   0.343       0.362 d-b            </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;  6 &lt;chr [2]&gt;   0.571       0     a-h            </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;  7 &lt;chr [2]&gt;   0.571       0     f-b            </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;  8 &lt;chr [2]&gt;   0.604       0.527 c-e            </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;  9 &lt;chr [2]&gt;   0.604       0.527 c-g            </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 10 &lt;chr [2]&gt;   0.604       0.527 d-e            </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; # … with 18 more rows</span></a></code></pre></div>
</div>
<div id="row-column-exclusivity-test" class="section level3">
<h3 class="hasAnchor">
<a href="#row-column-exclusivity-test" class="anchor"></a>Row-Column Exclusivity test</h3>
<p>This test conditions on the rows and columns of the mutation matrix, thus accounting for the number of mutations per gene and per sample. This comes at a cost in speed of computation as the RC test is much slower to run. Here, I run the test using 10,000 permutations. Also, the paramters <code>min_mut_events</code> and <code>min_times_mut</code> are set to 0 becasue the test data set is so small; on real data, these should be non-zero values (the defaults are 2 and 3, respectively) to ignore very rare events.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">rc_res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rc_test.html">rc_test</a></span>(simple_dataset, sample_name, mutated_gene, <span class="dt">k =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                  <span class="dt">which_test =</span> <span class="st">"exclusivity"</span>, <span class="dt">N_perms =</span> <span class="fl">1e4</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                  <span class="dt">min_mut_events =</span> <span class="dv">0</span>, <span class="dt">min_times_mut =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gene_sets_print =</span> purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span>(gene_sets, <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(.x[[<span class="dv">1</span>]], <span class="st">"-"</span>, .x[[<span class="dv">2</span>]]))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(p_val, gene_sets_print)</a></code></pre></div>
</div>
<div id="comparing-results" class="section level3">
<h3 class="hasAnchor">
<a href="#comparing-results" class="anchor"></a>Comparing results</h3>
<p>By comparing the p-values returned by each test, we can see which was more sensitive.</p>
<p>The first plot below just shows the p-values for each gene set tested, and the second shows the difference between values. . For most of the comparisons, the Fisher’s exact test returned higher p-values</p>
<p><img src="compare_rc_to_fisher_files/figure-html/plot_pvals-1.png" width="700"></p>
<p><img src="compare_rc_to_fisher_files/figure-html/plot_diff-1.png" width="700"></p>
<p>Both tests easily identify the obvious and robust mutually exclusive mutational pattern of genes “a” and “b”. The Fisher’s exact test returned a smaller p-value for the gene sets a-c, a-d, c-b, and d-b. These four gene sets show a large degree of co-mutation and a few instances of exclusivity. Where the RC-test outperforms the Fisher’s exact test is with the more rare, yet strict, patterns of mutual exclusivity such as gene sets a-g or a-h, and e-b and f-b. Even more striking are the rare events between “e” and “f” which are both rarely mutated but always mutually exclusive. Their rarity diminishes the sensitivity of the Fisher’s exact test, but the RC-test, by using the mutational frequencies of the samples, is better at recognizing these these potentially important trends.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#the-input-data">The Input Data</a></li>
      <li><a href="#one-sided-fishers-exact-test">One-sided Fisher’s exact test</a></li>
      <li><a href="#comparing-tests-for-mutual-exclusivity">Comparing tests for mutual exclusivity</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua H Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
