<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing Edge Swap Algorithms • wext</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparing Edge Swap Algorithms">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wext</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/compare_rc_to_fisher.html">Comparing the RC-test to the Fisher's exact test</a>
    </li>
    <li>
      <a href="../articles/comparing_swappers.html">Comparing Edge Swap Algorithms</a>
    </li>
    <li>
      <a href="../articles/computing_probabilities.html">Computing the Weighted Exclusivity Test (WExT)</a>
    </li>
    <li>
      <a href="../articles/simpleexample-hardway.html">Simple Example (the hard way)</a>
    </li>
    <li>
      <a href="../articles/statistics.html">WExT Statistics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/jhrcook/wext">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/JoshDoesa">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Comparing Edge Swap Algorithms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhrcook/wext/blob/master/vignettes/comparing_swappers.Rmd"><code>vignettes/comparing_swappers.Rmd</code></a></small>
      <div class="hidden name"><code>comparing_swappers.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(wext)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidygraph)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tibble)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(bench)</a></code></pre></div>
<p>This is just a quick comparison of the edge swapping algorithms used in this package.</p>
<p>The first step is to create a bipartite graph for the test.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">v1 &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">2</span>, <span class="fl">1e3</span>, <span class="dv">2</span>), <span class="fl">1e4</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">v2 &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="fl">1e3</span><span class="op">+</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="fl">1e4</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">bgr &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">node1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(v1),</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">              <span class="dt">node2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(v2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/tidygraph/topics/tbl_graph">as_tbl_graph</a></span>(<span class="dt">directed =</span> <span class="ot">FALSE</span>) <span class="op">%N&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/tidygraph/topics/reexports">mutate</a></span>(<span class="dt">type =</span> name <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(v1)))</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">bgr</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; # A tbl_graph: 1001 nodes and 9799 edges</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; # A bipartite simple graph with 1 component</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; # Node Data: 1,001 x 2 (active)</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;   name  type </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt;   &lt;chr&gt; &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; 1 898   TRUE </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; 2 266   TRUE </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; 3 374   TRUE </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; 4 574   TRUE </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; 5 910   TRUE </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; 6 202   TRUE </span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; # … with 995 more rows</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; # Edge Data: 9,799 x 2</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt;    from    to</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; 1     1   501</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; 2     2   502</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt; 3     3   503</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; # … with 9,796 more rows</span></a></code></pre></div>
<p>This graph has 1001 nodes and 9799 edges.</p>
<p>The first bipartite edge swapping method is <code><a href="../reference/bipartite_edge_swap.html">bipartite_edge_swap()</a></code> which relies on the ‘igraph’ and ‘tidygraph’ APIs for handling all of the data and logically manipulates a tidygraph graph object. This was the easiest implementation, though I expected that the manipulation of high-level data types would be a time-suck. This first test runs the edge swapping algorithm to swap 100 edges 20 times.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(<span class="kw"><a href="../reference/bipartite_edge_swap.html">bipartite_edge_swap</a></span>(bgr, <span class="dt">N =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">            <span class="dt">iterations =</span> <span class="dv">20</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; 1       6s    6.39s     0.157    1.96GB     10.8</span></a></code></pre></div>
<p>The second edge swapping algorithm implementation is in <code><a href="../reference/bipartite_edge_swap2.html">bipartite_edge_swap2()</a></code>. This method took more work on my end, though its use of vector manipulations rapidly increased the speed of the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(<span class="kw"><a href="../reference/bipartite_edge_swap2.html">bipartite_edge_swap2</a></span>(bgr, <span class="dt">N =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">            <span class="dt">iterations =</span> <span class="dv">20</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 1    513ms    566ms      1.74     234MB     6.88</span></a></code></pre></div>
<p>This first test ran 100 edge swaps on the graph <code>bgr</code>. The first method took 5.82 seconds on average (a median of 10 iterations) while the second took about 820 ms. Thus, the second method is much faster. Another striking difference is the amount of memory each method was allocated - the first method took about 2 GB of RAM! It also called the garbage collector and order of magnitude more frequently.</p>
<p>To specifically test everything <em>expect</em> for the edge swapping, I re-ran the same test but only conducting 1 edge swap in each iteration.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># first method</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(<span class="kw"><a href="../reference/bipartite_edge_swap.html">bipartite_edge_swap</a></span>(bgr, <span class="dt">N =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">            <span class="dt">iterations =</span> <span class="dv">50</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 1   56.4ms   69.4ms      14.1    20.9MB     8.44</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># second method</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(<span class="kw"><a href="../reference/bipartite_edge_swap2.html">bipartite_edge_swap2</a></span>(bgr, <span class="dt">N =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">            <span class="dt">iterations =</span> <span class="dv">50</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 1    348ms    408ms      2.46     160MB     7.34</span></a></code></pre></div>
<p>Interestingly, the first method (based around the ‘igraph’ and ‘tidygraph’ APIs) is substantially faster to do all of the other steps in the edge swapping process. This is likely because the second method must first transform the bipartite graph <code>bgr</code> into the list of vectors while the first method works directly on the tidygraph object (it only does this once per call to <code>bipartite_edge_swap2</code>). Still, it may be worth poking around on the setup steps in the second method to improve its efficiency.</p>
<p>To further test this hypothesis, the difference should shrink if I use a smaller bipartite graph.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">v1 &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="dv">2</span>), <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">v2 &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="dv">51</span>, <span class="dv">2</span>), <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">bgr &lt;-<span class="st"> </span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="dt">node1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(v1),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">              <span class="dt">node2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(v2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/tidygraph/topics/tbl_graph">as_tbl_graph</a></span>(<span class="dt">directed =</span> <span class="ot">FALSE</span>) <span class="op">%N&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/tidygraph/topics/reexports">mutate</a></span>(<span class="dt">type =</span> name <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(v1)))</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">bgr</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; # A tbl_graph: 51 nodes and 95 edges</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; # A bipartite simple graph with 1 component</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; # Node Data: 51 x 2 (active)</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;   name  type </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;   &lt;chr&gt; &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; 1 6     TRUE </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; 2 32    TRUE </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; 3 16    TRUE </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; 4 12    TRUE </span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; 5 2     TRUE </span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; 6 8     TRUE </span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; # … with 45 more rows</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; #</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; # Edge Data: 95 x 2</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;    from    to</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; 1     1    26</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; 2     2    27</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; 3     3    28</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; # … with 92 more rows</span></a></code></pre></div>
<p>This smaller graph has 51 nodes and 95 edges. I now re-run the test with only 1 edge swap.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># first method</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(<span class="kw"><a href="../reference/bipartite_edge_swap.html">bipartite_edge_swap</a></span>(bgr, <span class="dt">N =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">            <span class="dt">iterations =</span> <span class="dv">50</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 1   21.6ms   24.7ms      35.4     324KB     4.96</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co"># second method</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(<span class="kw"><a href="../reference/bipartite_edge_swap2.html">bipartite_edge_swap2</a></span>(bgr, <span class="dt">N =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">            <span class="dt">iterations =</span> <span class="dv">50</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; 1   5.38ms   6.15ms      151.     201KB     3.02</span></a></code></pre></div>
<p>Now, the second method is actually faster because it was easier to change to the vector manipulation than lug around the relatively “heavy” tidygraph object (see the <code>mem_alloc</code> columns). You can see that the garbage collection intervened a few times (in the <code>gc/sec</code> and <code>n_gc</code> column).</p>
<p>The next step will be to implement <code>bipartite_edge_swap2</code> in C++ using the ‘Rcpp’ package. This should introduce a few speed boosts, too.</p>
<hr>
<p>For comparison, here is the same test using the heavily optimized edge swapping algorithm in ‘igraph’. While fast, this test does not preserve the bipartite nature of the graph, thus I cannot use it for ‘WExT’.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">bench<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bench/topics/mark">mark</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  igraph<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/rewire">rewire</a></span>(bgr, igraph<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/keeping_degseq">keeping_degseq</a></span>(<span class="dt">loops =</span> <span class="ot">FALSE</span>, <span class="dt">niter =</span> <span class="dv">100</span>)),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="dt">iterations =</span> <span class="dv">10</span>, <span class="dt">filter_gc =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>expression)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;        min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;   &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 1    332µs    560µs     1554.    44.2KB        0</span></a></code></pre></div>
<p>I think that one of the reasons for this method’s speed is that it is implemented in C++.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua H Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
