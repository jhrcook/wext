<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WExT Statistics • wext</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="WExT Statistics">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wext</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/computing_probabilities.html">Computing the Weighted Exclusivity Test (WExT)</a>
    </li>
    <li>
      <a href="../articles/simpleexample-hardway.html">Simple Example (the hard way)</a>
    </li>
    <li>
      <a href="../articles/statistics.html">WExT Statistics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/jhrcook/wext">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/JoshDoesa">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>WExT Statistics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhrcook/wext/blob/master/vignettes/statistics.Rmd"><code>vignettes/statistics.Rmd</code></a></small>
      <div class="hidden name"><code>statistics.Rmd</code></div>

    </div>

    
    
<p>Here, I explain the statistics behind the weighted exclusivity test. It begins with a section on notation, followed by three sections, one for each test, culminating with the weighted exclusivity test that was the major contribution of the paper.</p>
<p>In the <a href="computing_probabilities.html">“Computing the weighted exclusivity test”</a> vignette, I explain how the test is computationally executed.</p>
<div id="notation" class="section level2">
<h2 class="hasAnchor">
<a href="#notation" class="anchor"></a>Notation</h2>
<p><span class="math inline">\(\{g_i\}^m_{i=1}\)</span>: a set of <span class="math inline">\(m\)</span> genes<br><span class="math inline">\(\{s_j\}^n_{j=1}\)</span>: a set of <span class="math inline">\(n\)</span> samples</p>
<p><span class="math inline">\(A_{m \times n} \in \{0,1\}\)</span>: a binary mutation matrix; <span class="math inline">\(a_{ij} = 1\)</span> is gene <span class="math inline">\(g_i\)</span> is mutated in sample <span class="math inline">\(s_j\)</span></p>
<p><span class="math inline">\(M \subseteq \{g_i\}^m_{i=1}\)</span> a set of <span class="math inline">\(k\)</span> genes</p>
<p><em>co-occurring</em>: a sample <span class="math inline">\(s_j\)</span> has multiple genes in <span class="math inline">\(M\)</span> mutated<br>
    <span class="math inline">\(g_i, g_l \in M\)</span> and <span class="math inline">\(a_{ij}=1; a_{il}=1\)</span></p>
<p><em>mutually exclusive</em>: a sample <span class="math inline">\(s_j\)</span> has multiple only one gene in <span class="math inline">\(M\)</span> mutated<br>
    <span class="math inline">\(g_i, g_l \in M\)</span> and <span class="math inline">\(a_{ij}=0; a_{il}=1\)</span></p>
<p><span class="math inline">\(r_i = \sum^{m}_{j=1}{a_{ij}}\)</span>: (row-sum) number of samples with mutations in gene <span class="math inline">\(g_i\)</span><br><span class="math inline">\(c_i = \sum^{n}_{i=1}{a_{ij}}\)</span>: (col-sum) number of genes mutated in sample <span class="math inline">\(s_j\)</span></p>
<p><span class="math inline">\(z_M\)</span>: number of samples with co-occurring mutations in <span class="math inline">\(M\)</span><br><span class="math inline">\(t_M\)</span>: number of samples with mutually exclusive mutations in <span class="math inline">\(M\)</span></p>
<p><span class="math inline">\(B(M)\)</span>: the submatrix of a mutation matrix <span class="math inline">\(B\)</span> with the rows corresponding to the gene set <span class="math inline">\(M\)</span><br><span class="math inline">\(t_{B(M)}\)</span>: the number of mutually exclusive mutation in <span class="math inline">\(B(M)\)</span><br>
    we use <span class="math inline">\(t_M = t_{A(M)}\)</span> from here on</p>
</div>
<div id="permutation-tests-for-mutual-exclusivity" class="section level2">
<h2 class="hasAnchor">
<a href="#permutation-tests-for-mutual-exclusivity" class="anchor"></a>Permutation tests for mutual exclusivity</h2>
<div id="row-exclusivity" class="section level3">
<h3 class="hasAnchor">
<a href="#row-exclusivity" class="anchor"></a>Row-exclusivity</h3>
<p><strong>This test finds the probability <span class="math inline">\(\Phi_{R}(M)\)</span> of observing at least <span class="math inline">\(t_M\)</span> mutually exclusive mutations in a gene set <span class="math inline">\(M\)</span> given that each <span class="math inline">\(g_i \in M\)</span> is mutated in <span class="math inline">\(r_i\)</span> samples.</strong></p>
<p>Therefore, this test conditions on the row sums of the mutation matrix.</p>
<p><span class="math inline">\(\Omega_R\)</span>: the set of mutation matrices with the same row sums as <span class="math inline">\(A\)</span> (observed mutation matrix)</p>
<p><span class="math inline">\(\varepsilon_R = \{ B \in \Omega_R: t_{B(M)} \ge t_M \}\)</span>: the set of mutation matrices with at least <span class="math inline">\(t_M\)</span> mutually exclusive mutation in <span class="math inline">\(M\)</span>.</p>
<p>We can then define the probability</p>
<p><span class="math display">\[
\begin{align}
\tag{1}
\Phi_{R}(M) = \frac{|\varepsilon_R|}{|\Omega_R|}
\end{align}
\]</span></p>
<p>which is the number of possible mutation matrices with the same row sums as <span class="math inline">\(A\)</span> but as equal or more extreme mutual exclusivity divided by the total possible number of mutation matrices with the same row sums as <span class="math inline">\(A\)</span>. Thus, this is the <span class="math inline">\(p\)</span>-value of the row-exclusivity test.</p>
</div>
<div id="row-column-exclusivity" class="section level3">
<h3 class="hasAnchor">
<a href="#row-column-exclusivity" class="anchor"></a>Row-column-exclusivity</h3>
<p><strong>This test finds the probability <span class="math inline">\(\Phi_{RC}(M)\)</span> of observing at least <span class="math inline">\(t_M\)</span> mutually exclusive mutations in a gene set <span class="math inline">\(M\)</span> given that each <span class="math inline">\(g_i \in M\)</span> is mutated in <span class="math inline">\(r_i\)</span> samples and each <span class="math inline">\(s_j\)</span> is mutated in <span class="math inline">\(c_j\)</span> genes.</strong></p>
<p>Therefore, this test conditions on the row and column sums of the mutation matrix by holding the frequency of mutation of a gene and number of mutations per sample constant.</p>
<p><span class="math inline">\(\Omega_{RC}\)</span>: the set of mutation matrices with the same row and column sums as <span class="math inline">\(A\)</span> (observed mutation matrix)</p>
<p><span class="math inline">\(\varepsilon_{RC} = \{ B \in \Omega_{RC}: t_{B(M)} \ge t_M \}\)</span>: the set of mutation matrices with at least <span class="math inline">\(t_M\)</span> mutually exclusive mutations in <span class="math inline">\(M\)</span>.</p>
<p>We can then define the probability</p>
<p><span class="math display">\[
\begin{align}
\tag{2}
\Phi_{RC}(M) = \frac{|\varepsilon_{RC}|}{|\Omega_{RC}|}
\end{align}
\]</span></p>
<p>which is the number of possible mutation matrices with the same row and column sums as <span class="math inline">\(A\)</span> but as equal or more extreme mutual exclusivity divided by the total possible number of mutation matrices with the same row and column sums as <span class="math inline">\(A\)</span>. Thus, this is the <span class="math inline">\(p\)</span>-value of the row-column-exclusivity test.</p>
</div>
<div id="weighted-exact-test-for-mutual-exclusivity" class="section level3">
<h3 class="hasAnchor">
<a href="#weighted-exact-test-for-mutual-exclusivity" class="anchor"></a>Weighted exact test for mutual exclusivity</h3>
<blockquote>
<p>This is the new test contributed by this paper.</p>
</blockquote>
<p><strong>This test finds the probability <span class="math inline">\(\Phi_{WR}(M)\)</span> of observing at least <span class="math inline">\(t_M\)</span> mutually exclusive mutations in a gene set <span class="math inline">\(M\)</span> given that <span class="math inline">\(g_i \in M\)</span> is mutated in <span class="math inline">\(r_i\)</span> samples and a per-gene, per-sample mutation probability matrix <span class="math inline">\(W\)</span> that prescribes weights with the presence or absence of individual mutations.</strong></p>
<p>Therefore, this test conditions on the row sums of the mutation matrix (the number of mutations in each sample is held constant) and a mutation probability weight matrix. Therefore, this model takes into account the fact that not all genes are mutated with the same probability (due to length of the gene, chromatin accessibility, etc.).</p>
<p><span class="math inline">\(\{X_{ij}\}^{n}_{j=1}\)</span>: a set of Bernoulli random variables for each gene <span class="math inline">\(g_i\)</span> with success probabilities <span class="math inline">\(W = [w_{ij}]\)</span>. It is therefore defined as</p>
<p><span class="math display">\[
\begin{align}
\tag{3}
\text{Pr}(X_{ij} = l) = \begin{cases}
    w_{ij} &amp; \text{if } l=1\\
    1-w_{ij} &amp; \text{if } l=0
  \end{cases}
\end{align}
\]</span></p>
<p>where <span class="math inline">\(w_{ij}\)</span> is the probability that gene <span class="math inline">\(g_i\)</span> is mutated in sample <span class="math inline">\(s_j\)</span>.</p>
<p><span class="math inline">\(T_{Mj}\)</span>: a random variable equal to <span class="math inline">\(1\)</span> if <span class="math inline">\(s_j\)</span> has a mutually exclusive mutation in a gene set <span class="math inline">\(M\)</span> and <span class="math inline">\(0\)</span> otherwise.</p>
<p><span class="math inline">\(T_M = \sum^{n}_{j=1}{T_{Mj}}\)</span>: the number of mutually exclusive mutation in <span class="math inline">\(M\)</span> (the test statistic)</p>
<p>The sum of Bernoulli trials creates a distribution known as a <a href="https://en.wikipedia.org/wiki/Poisson_binomial_distribution">Poisson binomial distribution</a>. It is therefore the number of successes in <span class="math inline">\(n\)</span> independent yes/no experiments with probabilities of success <span class="math inline">\(\{p_1, p_2, ..., p_n\}\)</span>. If the probabilities for each experiment are the same, this special case is called a <a href="https://en.wikipedia.org/wiki/Binomial_distribution">binomial distribution</a>. Therefore, we define <span class="math inline">\(Y_i\)</span> below as a Poisson binomial distribution.</p>
<p><span class="math inline">\(Y_i = \sum^{n}_{j=1}{X_{ij}}\)</span>: a Poisson binomial distributed variable for the number of mutation in <span class="math inline">\(g_i\)</span><br>
    let <span class="math inline">\(Y_M = [Y_i]_{i \in M}\)</span></p>
<p>Therefore, we want to find the tail probability (the <em>p</em>-value) of observing <span class="math inline">\(t_M\)</span> mutually exclusive mutations in <span class="math inline">\(M\)</span> given that <span class="math inline">\(g_i\)</span> is mutated in <span class="math inline">\(r_i\)</span> samples (i.e. holding the row-sums constant). We can define this as</p>
<p><span class="math display">\[
\begin{align}
\tag{4}
\Phi_{WR}(M) = \text{Pr}(T_M \ge t_M | Y_M = \vec{r}_M)
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\vec{r}_M = [r_i]_{i \in M}\)</span>. This is the probability of observing at least <span class="math inline">\(t_M\)</span> mutually exclusive mutations in a gene set <span class="math inline">\(M\)</span> under the proposed model.</p>
<p>The conditional of <span class="math inline">\(\Phi_{WR}(M)\)</span> assumes that <span class="math inline">\(Y_i = r_i\)</span>. This implies the following list of equalities that will need to be satisfied by <span class="math inline">\(W\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\tag{5}
\sum^{n}_{j=1}{w_{ij}} &amp;= \sum^{n}_{j=1}{E[X_{ij}]}
  = E \left[ \sum^{n}_{j=1}{X_{ij}} \right]
  = E[Y_i]
  = r_i
\end{align}
\]</span></p>
</div>
</div>
<div id="approximating-the-permutation-tests-with-the-weighted-exclusivity-test" class="section level2">
<h2 class="hasAnchor">
<a href="#approximating-the-permutation-tests-with-the-weighted-exclusivity-test" class="anchor"></a>Approximating the permutation tests with the weighted exclusivity test</h2>
<p>Both sets of mutation matrices <span class="math inline">\(\Omega_{R}\)</span> and <span class="math inline">\(\Omega_{RC}\)</span> determines a per-gene, per-samples weight matrix <span class="math inline">\(W\)</span> comprised of the probability <span class="math inline">\(w_ij\)</span> of observing a mutation in gene <span class="math inline">\(g_i\)</span> in sample <span class="math inline">\(s_j\)</span></p>
<p><span class="math display">\[
\begin{align}
\tag{6}
W = \frac{1}{|\Omega|} \sum_{B \in \Omega}{B}
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\Omega\)</span> is either <span class="math inline">\(\Omega_{R}\)</span> or <span class="math inline">\(\Omega_{RC}\)</span> for <span class="math inline">\(W_R\)</span> or <span class="math inline">\(W_{RC}\)</span>, respectively. Because both <span class="math inline">\(\Omega_{R}\)</span> and <span class="math inline">\(\Omega_{RC}\)</span> keep the row-sums fixed, this definition of <span class="math inline">\(W\)</span> satisfies the equalities in equation <span class="math inline">\((5)\)</span>.</p>
<p>For the row-exclusivity test, each row of <span class="math inline">\(B \in \Omega_R\)</span> can be considered separately. Thus, <span class="math inline">\(W\)</span> simplifies to</p>
<p><span class="math display">\[
\begin{align}
\tag{7}
W_R = \left[w_{ij} = \frac{r_i}{n} \right]
\end{align}
\]</span></p>
<p>The authors do not know of a closed-form expression for the weights <span class="math inline">\(w_{ij}\)</span> for <span class="math inline">\(W_RC\)</span> because the rows and columns cannot be considered separately. Thus, they resorted to generating an empirical weight matrix <span class="math inline">\(W^{N}_{RC} = [w_{ij}]\)</span> for <span class="math inline">\(\Omega_{RC}\)</span> by drawing <span class="math inline">\(N\)</span> matrices <span class="math inline">\(\Omega^{N}_{RC}\)</span> uniformly at random from <span class="math inline">\(\Omega_{RC}\)</span> and calculating the weights from each using equation <span class="math inline">\((6)\)</span>. A great explanation of the process can be found in the Methods section of “Mutual exclusivity analysis identifies oncogenic network modules” by Ciriello <em>et al.</em> (2012). It is based off of the algorithm created by Milo <em>et al.</em> in “On the uniform generation of random graphs with prescribed degree sequences” (2003). Briefly the algorithm is as follows for a bipartite graph <span class="math inline">\(G\)</span> with node groups <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:</p>
<ol style="list-style-type: decimal">
<li>Randomly select two edges <span class="math inline">\(e_1 = (a,b)\)</span> and <span class="math inline">\(e_2 = (c,d)\)</span> where nodes <span class="math inline">\(a,c \in X\)</span> and <span class="math inline">\(b,d \in Y\)</span> and there are no edges between the nodes already; i.e. <span class="math inline">\((a,d) \notin G(E); (c,b) \notin G(E)\)</span>.</li>
<li>Remove edges <span class="math inline">\(e_1 = (a,b)\)</span> and <span class="math inline">\(e_2 = (c,d)\)</span>.</li>
<li>Add new edges <span class="math inline">\((a,d)\)</span> and <span class="math inline">\((c,b)\)</span>
</li>
</ol>
<p>It was found empirically that iterating this process <span class="math inline">\(Q \times |G(E)|\)</span>, where Q is the number of random graphs you want in total and <span class="math inline">\(|G(E)|\)</span> is the number of edges, if sufficient.</p>
<p>Finally, they assume that every gene has a non-zero probability of being mutated, thus set <span class="math inline">\(w_{ij} = \frac{1}{2N}\)</span> if there is no mutation in gene <span class="math inline">\(g_i\)</span> for sample <span class="math inline">\(s_j\)</span> in the matrix from <span class="math inline">\(\Omega^N_{RC}\)</span>.</p>
<hr>
<p>Please report and mistakes or suggest additional clarification as an <a href="https://github.com/jhrcook/wext/issues">Issue</a> on GitHub.</p>
<p>Link to the original manuscript by Leiserson <em>et al.</em> (2016): <a href="https://academic.oup.com/bioinformatics/article/32/17/i736/2450792">A weighted exact test for mutually exclusive mutations in cancer.</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#notation">Notation</a></li>
      <li><a href="#permutation-tests-for-mutual-exclusivity">Permutation tests for mutual exclusivity</a></li>
      <li><a href="#approximating-the-permutation-tests-with-the-weighted-exclusivity-test">Approximating the permutation tests with the weighted exclusivity test</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua H Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
